# - name: Compare ACLs
#   hosts: 
#     - all
#   order: sorted
#   connection: local
#   gather_facts: no
      
#   tasks:
#     - name: show common commands for comparison
#       asa_command:
#         commands:
#         - terminal pager 0
#         - show running-config access-list
#       register: asainfo
#       ignore_errors: True
    
#     # - debug:
#     #     var: asainfo
    
#     - name: set fact for compare variables
#       set_fact:
#         aclremark: "{{ asainfo.stdout.1 | regex_findall ('access-list Split.*\\ remark.*') }}"
#         aclpermit: "{{ asainfo.stdout.1 | regex_findall ('access-list Split.*\\ permit.*.*\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}') }}"
#         aclcompremark: "{{ hostvars['USEMC-SECVSC001.na.xom.com'].aclcompremark }}"
#         aclcomppermit: "{{ hostvars['USEMC-SECVSC001.na.xom.com'].aclcomppermit }}"
#       ignore_errors: True
            
#     - name: Comparing arrays
#       set_fact:
#         remark: "{{ aclremark | difference(aclcompremark) }}"   # compare the items inside the array no mather the order
#         permit: "{{ aclpermit | difference(aclcomppermit) }}"
    
#     - name: Print response 
#       debug: 
#         msg:
#          - "Remarks to change:"
#          - "{{remark}}"
#          - "Permits to change: "
#          - "{{permit}}"
#       ignore_errors: True

#     - name: Delete if present
#       file:
#         path: ./corpvpnacl.txt
#         state: absent
#       run_once: true
#       delegate_to: localhost
    
#     - name: Create txt file
#       file:
#         path: ./corpvpnacl.txt
#         state: touch
#       run_once: true
#       delegate_to: localhost
    
#     - name: Create header to txt file
#       lineinfile:
#         path: ./corpvpnacl.txt
#         regexp: '^timestamp'
#         line: Differences on Split tunnel ACL
    
#     - name: Put data at the end of the txt file
#       lineinfile:
#         path: ./corpvpnacl.txt
#         insertafter: EOF
#         line: "\n\n {{inventory_hostname_short|upper}}\n\n Remarks to change: \n {{remark | join (' \n ')}} \n\n Permits to change: \n {{permit | join (' \n ')}}"
                      
#     - name: Print the txt file 
#       debug: 
#         msg:
#          - "{{ lookup('file', './corpvpnacl.txt') }}"
#       run_once: true
            
# - name: push to github
#   hosts:
#     - localhost
#   connection: local
#   gather_facts: no

#   tasks:
#     - name: shell commands
#       shell: |
#         git add corpvpnacl.txt
#         git add asainfobase.txt
#         git add {{ inventory_hostname }}_asainfo.txt
#         git add {{ inventory_hostname }}_diff_result.txt
#         git commit -am "commit from tower crop_vpn_v02.yml"
#         git push origin master
#       run_once: true  
#       register: shell_output